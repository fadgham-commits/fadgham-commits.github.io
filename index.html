<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Flappy Bird HTML</title>
  <style>
    body {
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: linear-gradient(#70c5ce, #ffffff);
      font-family: sans-serif;
    }
    canvas {
      background: #70c5ce;
      border: 2px solid #333;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="400" height="600"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let frames = 0;
    const DEGREE = Math.PI/180;

    // Burung
    const bird = {
      x: 50,
      y: 150,
      w: 30,
      h: 30,
      gravity: 0.25,
      jump: 4.6,
      speed: 0,
      draw(){
        ctx.fillStyle = "yellow";
        ctx.fillRect(this.x, this.y, this.w, this.h);
      },
      update(){
        this.speed += this.gravity;
        this.y += this.speed;

        if(this.y + this.h >= canvas.height){
          gameOver = true;
        }
      },
      flap(){
        this.speed = -this.jump;
      }
    };

    // Pipa
    const pipes = [];
    const pipeWidth = 60;
    const pipeGap = 120;

    function drawPipes(){
      ctx.fillStyle = "green";
      for(let i=0; i<pipes.length; i++){
        let p = pipes[i];
        ctx.fillRect(p.x, 0, pipeWidth, p.top);
        ctx.fillRect(p.x, p.top + pipeGap, pipeWidth, canvas.height - (p.top + pipeGap));
      }
    }

    function updatePipes(){
      if(frames % 100 === 0){
        let top = Math.floor(Math.random() * (canvas.height - pipeGap - 100)) + 50;
        pipes.push({x: canvas.width, top: top});
      }
      for(let i=0; i<pipes.length; i++){
        let p = pipes[i];
        p.x -= 2;

        // tabrakan
        if(bird.x < p.x + pipeWidth && bird.x + bird.w > p.x &&
           (bird.y < p.top || bird.y + bird.h > p.top + pipeGap)){
          gameOver = true;
        }

        if(p.x + pipeWidth < 0){
          pipes.splice(i,1);
          score++;
        }
      }
    }

    // Skor
    let score = 0;
    let gameOver = false;

    function drawScore(){
      ctx.fillStyle = "#000";
      ctx.font = "24px Arial";
      ctx.fillText("Score: " + score, 10, 30);
    }

    // Loop
    function loop(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      bird.update();
      bird.draw();
      updatePipes();
      drawPipes();
      drawScore();

      if(!gameOver){
        frames++;
        requestAnimationFrame(loop);
      } else {
        ctx.fillStyle = "red";
        ctx.font = "40px Arial";
        ctx.fillText("Game Over", canvas.width/2 - 100, canvas.height/2);
      }
    }

    // Kontrol
    document.addEventListener("keydown", function(e){
      if(e.code === "Space"){
        bird.flap();
        if(gameOver){
          // reset
          bird.y = 150;
          bird.speed = 0;
          pipes.length = 0;
          score = 0;
          gameOver = false;
          frames = 0;
          loop();
        }
      }
    });

    loop();
  </script>
</body>
</html>
